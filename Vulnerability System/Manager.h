#pragma once

#include "pch.h"
#include "User.h"
#include "vulnerability.h"

class Manager
{
public:
	Manager();
	~Manager();

	bool login(std::string&& uid, std::string&& password);
	bool logout();

	bool addUser(User&& new_user);
	bool addVulnerability(Vulnerability&& new_vul);

	bool deleteUser();
	bool deleteVulnerability();

	User queryUserInfo() const;
	Vulnerability queryVulnerability() const;

	bool changeUser(User&& user);
	bool modifyUserInfo(int type, std::string&& data);
	bool changeVulnerability(Vulnerability&& vul);
	bool modifyVulnerabilityInfo(int type, std::string&& data);

private:
	std::unique_ptr<User> _user;
	std::unique_ptr<Vulnerability> _vulnerability;
};

